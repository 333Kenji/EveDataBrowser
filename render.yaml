databases:
  - name: eve-data-browser-db
    # Request free tier; adjust if workspace rejects.
    plan: free

services:
  - type: web
    name: eve-data-browser-api
    env: docker
    plan: free
    repo: https://github.com/333Kenji/EveDataBrowser
    branch: main
    rootDir: app/api
    dockerfilePath: app/api/Dockerfile
    dockerContext: app/api
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: eve-data-browser-db
          property: connectionString
      - key: API_CORS_ALLOW_ORIGINS
        value: "*"
      - key: API_CACHE_TAXONOMY_MAX_AGE
        value: "3600"
      - key: API_CACHE_TAXONOMY_STALE
        value: "120"
      - key: API_CACHE_ITEMS_MAX_AGE
        value: "3600"
      - key: API_CACHE_ITEMS_STALE
        value: "120"
      - key: API_CACHE_MARKET_MAX_AGE
        value: "300"
      - key: API_CACHE_MARKET_STALE
        value: "120"
      - key: FEATURE_STRUCTURE_ORDERS
        value: "false"
      - key: STRUCTURE_ORDER_STRUCTURE_IDS
        value: ""

  - type: web
    name: eve-data-browser-web
    env: docker
    plan: free
    repo: https://github.com/333Kenji/EveDataBrowser
    branch: main
    rootDir: app/web
    dockerfilePath: app/web/Dockerfile
    dockerContext: app/web
    autoDeploy: true
    envVars:
      - key: VITE_API_BASE_URL
        # Replace after first deploy with the API's public URL, e.g., https://eve-data-browser-api.onrender.com
        value: https://REPLACE_WITH_API_URL

